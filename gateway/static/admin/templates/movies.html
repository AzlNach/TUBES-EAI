<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movies Management - Admin</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Admin CSS -->
    <link href="/static/admin/css/admin.css" rel="stylesheet">
</head>
<body>
    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="brand">
                <i class="fas fa-crown me-2"></i>
                <span>Cinema Admin</span>
            </div>
            <button class="btn-close-sidebar d-lg-none" id="closeSidebar">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="sidebar-menu">
            <div class="menu-section">
                <h6 class="menu-title">MAIN</h6>
                <a href="/admin" class="menu-item">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </a>
            </div>
            
            <div class="menu-section">
                <h6 class="menu-title">CONTENT MANAGEMENT</h6>
                <a href="/admin/movies" class="menu-item active">
                    <i class="fas fa-film"></i>
                    <span>Movies</span>
                </a>
                <a href="/admin/cinemas" class="menu-item">
                    <i class="fas fa-building"></i>
                    <span>Cinemas</span>
                </a>
            </div>
            
            <div class="menu-section">
                <h6 class="menu-title">USER MANAGEMENT</h6>
                <a href="/admin/users" class="menu-item">
                    <i class="fas fa-users"></i>
                    <span>Users</span>
                </a>
                <a href="/admin/bookings" class="menu-item">
                    <i class="fas fa-ticket-alt"></i>
                    <span>Bookings</span>
                </a>
            </div>
            
            <div class="menu-section">
                <h6 class="menu-title">ACCOUNT</h6>
                <a href="#" class="menu-item" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Top Navigation -->
        <nav class="topbar">
            <div class="topbar-left">
                <button class="btn-toggle-sidebar d-lg-none" id="toggleSidebar">
                    <i class="fas fa-bars"></i>
                </button>
                <h4 class="page-title mb-0">Movies Management</h4>
            </div>
            <div class="topbar-right">
                <div class="admin-profile">
                    <div class="dropdown">
                        <button class="btn btn-link dropdown-toggle" data-bs-toggle="dropdown">
                            <div class="avatar">
                                <i class="fas fa-user-shield"></i>
                            </div>
                            <span class="admin-name">Admin</span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Movies Content -->
        <div class="content-wrapper">
            <!-- Stats Cards -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card bg-primary text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h4 class="mb-1" id="total-movies-count">0</h4>
                                    <p class="mb-0">Total Movies</p>
                                </div>
                                <div class="align-self-center">
                                    <i class="fas fa-film fa-2x"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-success text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h4 class="mb-1" id="active-movies-count">0</h4>
                                    <p class="mb-0">Active Movies</p>
                                </div>
                                <div class="align-self-center">
                                    <i class="fas fa-play-circle fa-2x"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-info text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h4 class="mb-1" id="genres-count">0</h4>
                                    <p class="mb-0">Genres</p>
                                </div>
                                <div class="align-self-center">
                                    <i class="fas fa-tags fa-2x"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-warning text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h4 class="mb-1" id="avg-rating">0.0</h4>
                                    <p class="mb-0">Avg Rating</p>
                                </div>
                                <div class="align-self-center">
                                    <i class="fas fa-star fa-2x"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Header with Add Button -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h2>Movies Catalog</h2>
                    <p class="text-muted">Manage your movie collection</p>
                </div>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addMovieModal">
                    <i class="fas fa-plus me-2"></i>Add New Movie
                </button>
            </div>

            <!-- Filters -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-3">
                            <label for="genre-filter" class="form-label">Filter by Genre</label>
                            <select class="form-select" id="genre-filter">
                                <option value="">All Genres</option>
                                <option value="Action">Action</option>
                                <option value="Comedy">Comedy</option>
                                <option value="Drama">Drama</option>
                                <option value="Horror">Horror</option>
                                <option value="Romance">Romance</option>
                                <option value="Sci-Fi">Sci-Fi</option>
                                <option value="Thriller">Thriller</option>
                                <option value="Animation">Animation</option>
                                <option value="Adventure">Adventure</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="rating-filter" class="form-label">Minimum Rating</label>
                            <select class="form-select" id="rating-filter">
                                <option value="">Any Rating</option>
                                <option value="8">8.0+ ⭐⭐⭐⭐⭐</option>
                                <option value="7">7.0+ ⭐⭐⭐⭐</option>
                                <option value="6">6.0+ ⭐⭐⭐</option>
                                <option value="5">5.0+ ⭐⭐</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="search-input" class="form-label">Search Movies</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="search-input" placeholder="Search by title or description...">
                                <button class="btn btn-outline-secondary" type="button" id="clear-search">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                        <div class="col-md-2 d-flex align-items-end">
                            <div class="btn-group w-100" role="group">
                                <button type="button" class="btn btn-outline-primary active" id="grid-view" title="Grid View">
                                    <i class="fas fa-th"></i>
                                </button>
                                <button type="button" class="btn btn-outline-primary" id="list-view" title="List View">
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Loading State -->
            <div class="text-center py-5" id="loading-container" style="display: block;">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading movies...</span>
                </div>
                <p class="mt-3">Loading movies...</p>
            </div>

            <!-- Movies Grid View -->
            <div class="row g-4" id="movies-grid" style="display: none;">
                <!-- Movie cards will be populated here by JavaScript -->
            </div>

            <!-- Movies List View -->
            <div id="movies-list" style="display: none;">
                <!-- Movies table will be populated here by JavaScript -->
            </div>

            <!-- Empty State -->
            <div class="text-center py-5" id="empty-state" style="display: none;">
                <i class="fas fa-film fa-3x text-muted mb-3"></i>
                <h5>No movies found</h5>
                <p class="text-muted">No movies match your current filters.</p>
                <div class="mt-3">
                    <button class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#addMovieModal">
                        <i class="fas fa-plus me-2"></i>Add Your First Movie
                    </button>
                    <button class="btn btn-outline-secondary" onclick="clearAllFilters()">
                        <i class="fas fa-undo me-2"></i>Clear Filters
                    </button>
                </div>
            </div>

            <!-- Error State -->
            <div class="text-center py-5" id="error-state" style="display: none;">
                <i class="fas fa-exclamation-triangle fa-3x text-danger mb-3"></i>
                <h5>Error loading movies</h5>
                <p class="text-muted" id="error-message">Failed to load movies. Please try again.</p>
                <button class="btn btn-primary" onclick="loadMovies()">
                    <i class="fas fa-redo me-2"></i>Try Again
                </button>
            </div>

            <!-- Pagination -->
            <div class="d-flex justify-content-between align-items-center mt-4" id="pagination-container" style="display: none;">
                <div>
                    <p class="mb-0 text-muted">
                        Showing <span id="showing-start">1</span> to <span id="showing-end">12</span> 
                        of <span id="total-movies">0</span> movies
                    </p>
                </div>
                <nav>
                    <ul class="pagination mb-0" id="pagination-controls">
                        <!-- Pagination controls will be generated here -->
                    </ul>
                </nav>
            </div>
        </div>
    </div>

    <!-- Add Movie Modal -->
    <div class="modal fade" id="addMovieModal" tabindex="-1" aria-labelledby="addMovieModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addMovieModalLabel">
                        <i class="fas fa-plus-circle me-2"></i>Add New Movie
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="add-movie-form">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="movie-title" class="form-label">
                                        <i class="fas fa-film me-1"></i>Title *
                                    </label>
                                    <input type="text" class="form-control" id="movie-title" required 
                                           placeholder="Enter movie title...">
                                    <div class="invalid-feedback"></div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="movie-genre" class="form-label">
                                        <i class="fas fa-tags me-1"></i>Genre *
                                    </label>
                                    <select class="form-select" id="movie-genre" required>
                                        <option value="">Select Genre</option>
                                        <option value="Action">Action</option>
                                        <option value="Adventure">Adventure</option>
                                        <option value="Animation">Animation</option>
                                        <option value="Comedy">Comedy</option>
                                        <option value="Drama">Drama</option>
                                        <option value="Horror">Horror</option>
                                        <option value="Romance">Romance</option>
                                        <option value="Sci-Fi">Sci-Fi</option>
                                        <option value="Thriller">Thriller</option>
                                    </select>
                                    <div class="invalid-feedback"></div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="movie-duration" class="form-label">
                                        <i class="fas fa-clock me-1"></i>Duration (minutes) *
                                    </label>
                                    <input type="number" class="form-control" id="movie-duration" min="1" max="500" required
                                           placeholder="120">
                                    <div class="invalid-feedback"></div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="movie-rating" class="form-label">
                                        <i class="fas fa-star me-1"></i>Rating (1-10)
                                    </label>
                                    <input type="number" class="form-control" id="movie-rating" min="1" max="10" step="0.1"
                                           placeholder="7.5">
                                    <div class="invalid-feedback"></div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="movie-release-date" class="form-label">
                                        <i class="fas fa-calendar me-1"></i>Release Date
                                    </label>
                                    <input type="date" class="form-control" id="movie-release-date">
                                    <div class="invalid-feedback"></div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="movie-poster-url" class="form-label">
                                <i class="fas fa-image me-1"></i>Poster URL
                            </label>
                            <input type="url" class="form-control" id="movie-poster-url" 
                                   placeholder="https://example.com/poster.jpg">
                            <div class="form-text">Provide a URL to the movie poster image</div>
                            <div class="invalid-feedback"></div>
                        </div>
                        <div class="mb-3">
                            <label for="movie-description" class="form-label">
                                <i class="fas fa-align-left me-1"></i>Description
                            </label>
                            <textarea class="form-control" id="movie-description" rows="4" 
                                      placeholder="Enter movie description..."></textarea>
                            <div class="form-text">Provide a brief synopsis of the movie</div>
                            <div class="invalid-feedback"></div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="fas fa-times me-2"></i>Cancel
                        </button>
                        <button type="submit" class="btn btn-primary" id="save-movie">
                            <i class="fas fa-save me-2"></i>Save Movie
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Edit Movie Modal -->
    <div class="modal fade" id="editMovieModal" tabindex="-1" aria-labelledby="editMovieModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editMovieModalLabel">
                        <i class="fas fa-edit me-2"></i>Edit Movie
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="edit-movie-form">
                    <input type="hidden" id="edit-movie-id">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-movie-title" class="form-label">
                                        <i class="fas fa-film me-1"></i>Title *
                                    </label>
                                    <input type="text" class="form-control" id="edit-movie-title" required>
                                    <div class="invalid-feedback"></div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-movie-genre" class="form-label">
                                        <i class="fas fa-tags me-1"></i>Genre *
                                    </label>
                                    <select class="form-select" id="edit-movie-genre" required>
                                        <option value="">Select Genre</option>
                                        <option value="Action">Action</option>
                                        <option value="Adventure">Adventure</option>
                                        <option value="Animation">Animation</option>
                                        <option value="Comedy">Comedy</option>
                                        <option value="Drama">Drama</option>
                                        <option value="Horror">Horror</option>
                                        <option value="Romance">Romance</option>
                                        <option value="Sci-Fi">Sci-Fi</option>
                                        <option value="Thriller">Thriller</option>
                                    </select>
                                    <div class="invalid-feedback"></div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="edit-movie-duration" class="form-label">
                                        <i class="fas fa-clock me-1"></i>Duration (minutes) *
                                    </label>
                                    <input type="number" class="form-control" id="edit-movie-duration" min="1" max="500" required>
                                    <div class="invalid-feedback"></div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="edit-movie-rating" class="form-label">
                                        <i class="fas fa-star me-1"></i>Rating (1-10)
                                    </label>
                                    <input type="number" class="form-control" id="edit-movie-rating" min="1" max="10" step="0.1">
                                    <div class="invalid-feedback"></div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="edit-movie-release-date" class="form-label">
                                        <i class="fas fa-calendar me-1"></i>Release Date
                                    </label>
                                    <input type="date" class="form-control" id="edit-movie-release-date">
                                    <div class="invalid-feedback"></div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="edit-movie-poster-url" class="form-label">
                                <i class="fas fa-image me-1"></i>Poster URL
                            </label>
                            <input type="url" class="form-control" id="edit-movie-poster-url">
                            <div class="form-text">Provide a URL to the movie poster image</div>
                            <div class="invalid-feedback"></div>
                        </div>
                        <div class="mb-3">
                            <label for="edit-movie-description" class="form-label">
                                <i class="fas fa-align-left me-1"></i>Description
                            </label>
                            <textarea class="form-control" id="edit-movie-description" rows="4"></textarea>
                            <div class="form-text">Provide a brief synopsis of the movie</div>
                            <div class="invalid-feedback"></div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="fas fa-times me-2"></i>Cancel
                        </button>
                        <button type="submit" class="btn btn-primary" id="update-movie">
                            <i class="fas fa-save me-2"></i>Update Movie
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal fade" id="deleteMovieModal" tabindex="-1" aria-labelledby="deleteMovieModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-danger" id="deleteMovieModalLabel">
                        <i class="fas fa-exclamation-triangle me-2"></i>Confirm Delete
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete this movie?</p>
                    <div class="alert alert-warning">
                        <i class="fas fa-warning me-2"></i>
                        <strong>Warning:</strong> This action cannot be undone. The movie will be permanently removed from the system.
                    </div>
                    <p class="mb-0" id="delete-movie-name"><strong>Movie:</strong> <span id="delete-movie-title"></span></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancel
                    </button>
                    <button type="button" class="btn btn-danger" id="confirm-delete-movie">
                        <i class="fas fa-trash me-2"></i>Delete Movie
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Admin Auth JS -->
    <script src="/static/admin/js/auth.js"></script>
    <!-- Admin Movies JS -->
    <script src="/static/admin/js/movies.js"></script>
</body>
</html>